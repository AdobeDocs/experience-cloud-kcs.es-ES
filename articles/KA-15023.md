---
title: "Implementación de Video Analytics en Adobe Launch"
description: '"Explore la implementación del seguimiento de vídeo de YouTube en Adobe Launch con el SDK de Media Heartbeat".'
solution: Analytics
product: Analytics
applies-to: "Analytics"
keywords: "KCS, Adobe Launch, Video Analytics, Heartbeat, Adobe Experience Cloud, IU de Adobe Launch"
resolution: Resolution
internal-notes: "This implementation discussed in this article does not use Adobe Launch extension for Media Analytics."
bug: false
article-created-by: Eshaa Tiwari
article-created-date: "1/17/2024 2:25:48 PM"
article-published-by: Oleksandra Marchenko
article-published-date: "1/23/2024 3:11:35 PM"
version-number: 10
article-number: KA-15023
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=9c4f824d-44b5-ee11-a569-6045bd006b3d"
source-git-commit: 9f3e2e706456534db9221844e784616fa84472ea
workflow-type: tm+mt
source-wordcount: '661'
ht-degree: 0%

---

# Implementación de Video Analytics en Adobe Launch


Obtenga información sobre cómo mejorar los análisis mediante la implementación del seguimiento de vídeos de YouTube en Adobe Launch con el SDK de Media Heartbeat.

## Descripción {#description}


### Entorno

Este artículo proporciona los pasos para implementar el seguimiento de vídeo de YouTube en Adobe Launch mediante el SDK de Media Heartbeat.

### Problema/Síntomas

<b>Requisitos previos</b>


| <ol><li>Tiene una implementación de Launch de Adobe activa.</li><li>El grupo de informes está habilitado para la recopilación de medios.</li><li>El grupo de informes está asignado a la empresa de inicio de sesión de Analytics correcta en Adobe Experience Cloud.</li><li>Tiene derechos de publicación en Adobe Launch.</li><li>Está familiarizado con la interfaz de usuario de Adobe Launch y con cómo funciona.</li></ol><br> |
| --- |



## Resolución {#resolution}


<b>PASO 1: Crear nueva regla</b>

Cree una nueva regla en la propiedad de Launch de Adobe haciendo clic en el botón &quot;Agregar regla&quot; en la pestaña &quot;Reglas&quot;. Esta regla contiene la condición de evento para cargar vídeo de YouTube y los scripts de API de Video Analytics y YouTube iFrame.

- Especifique el nombre de la regla en el cuadro de texto Nombre.


<b>PASO 2: Añadir eventos o condiciones</b>

Haga clic en el botón + en Evento y condiciones para crear las condiciones necesarias para iniciar el vídeo de YouTube. En mi ejemplo, he añadido una condición &quot;Element Exists&quot; (El elemento existe) para buscar un &quot;player&quot; div específico para iniciar el vídeo de YouTube.

<b>PASO 3: Agregar acciones: variables de configuración</b>

Haga clic en el botón + debajo de acciones para crear un nuevo elemento de acción. Esto actuará como un único punto de configuración para configurar variables de Video Analytics. He utilizado algunos valores codificados. Sin embargo, puede utilizar elementos de datos para rellenar estas variables.

1. Seleccione &quot;Principal&quot; en el menú desplegable Extensión.
2. Seleccione &quot;Código personalizado&quot; en la lista desplegable Tipo de acción.
3. Agregue el nombre de la acción en el cuadro de texto Nombre.
4. Seleccione &quot;Javascript&quot; en Idioma.
5. Marque &quot;Ejecutar globalmente&quot;.
6. Haga clic en &quot;Abrir editor&quot;.
7. Añada el código y haga clic en guardar. Asegúrese de actualizar los valores según su compañía y grupo de informes.



```
(function() {    'use strict';
    // Export symbols.
    window.Configuration = {
        PLAYER: {
            NAME: 'sample player name'
            //VIDEO_ID: 'sample video id',
           //VIDEO_NAME: sample video name'
        },
        VISITOR: {
            MARKETING_CLOUD_ORG_ID: 'experience cloud ID',
            TRACKING_SERVER: 'tracking server',
            DPID: '',
            DPUUID: ''
        },
        APP_MEASUREMENT: {
            RSID: 'report suite id',
            TRACKING_SERVER: 'tracking server',
            PAGE_NAME: 'page name',
            CHAR_SET: 'UTF-8'
        },
        HEARTBEAT: {
            TRACKING_SERVER: 'heartbeat tracking server',
            PUBLISHER: 'publisher id',
            CHANNEL: 'channel',
            OVP: 'ovp name',
            SDK: 'sgk version',
       SSL: 'false',
       DEBUG: 'true'
        }
    };
})();
(function() {    'use strict';
    // Export symbols.
    window.Configuration = {
        PLAYER: {
            NAME: 'sample player name'
            //VIDEO_ID: 'sample video id',
           //VIDEO_NAME: sample video name'
        },
        VISITOR: {
            MARKETING_CLOUD_ORG_ID: 'experience cloud ID',
            TRACKING_SERVER: 'tracking server',
            DPID: '',
            DPUUID: ''
        },
        APP_MEASUREMENT: {
            RSID: 'report suite id',
            TRACKING_SERVER: 'tracking server',
            PAGE_NAME: 'page name',
            CHAR_SET: 'UTF-8'
        },
        HEARTBEAT: {
            TRACKING_SERVER: 'heartbeat tracking server',
            PUBLISHER: 'publisher id',
            CHANNEL: 'channel',
            OVP: 'ovp name',
            SDK: 'sgk version',
       SSL: 'false',
       DEBUG: 'true'
        }
    };
})();
```


<b>PASO 4: Añadir acciones al servicio de ID de visitante</b>

Media Analytics necesita una instancia del servicio de ID de visitante. Debe descargar el código del servicio de ID de visitante desde el Administrador de códigos en la interfaz de usuario de Adobe Analytics.

Una vez descargado el código del servicio de ID de visitante, haga clic en el botón + en acciones para crear un nuevo elemento de acción y, a continuación,

1. Seleccione &quot;Principal&quot; en el menú desplegable Extensión.
2. Seleccione &quot;Código personalizado&quot; en la lista desplegable Tipo de acción.
3. Agregue el nombre de la acción en el cuadro de texto Nombre.
4. Seleccione &quot;Javascript&quot; en Idioma.
5. Marque &quot;Ejecutar globalmente&quot;.
6. Haga clic en &quot;Abrir editor&quot;.
7. En la parte inferior, añada el siguiente código y haga clic en guardar.



```
var visitor = Visitor.getInstance("Experience Cloud ID", {
trackingServer: "tracking server", // same as s.trackingServer
trackingServerSecure: " tracking server " // same as s.trackingServerSecure
});
```


<b>PASO 5: Agregar acciones: código de Appmeasurement</b>

Media Analytics necesita una instancia de Appmeasurement. Debe descargarlo desde el Administrador de códigos en la interfaz de usuario de Adobe Analytics.

Una vez descargado el código de Appmeasurement, haga clic en el botón + en acciones para crear un nuevo elemento de acción y, a continuación,

1. Seleccione &quot;Principal&quot; en el menú desplegable Extensión.
2. Seleccione &quot;Código personalizado&quot; en la lista desplegable Tipo de acción.
3. Agregue el nombre de la acción en el cuadro de texto Nombre.
4. Seleccione &quot;Javascript&quot; en Idioma.
5. Marque &quot;Ejecutar globalmente&quot;.
6. Haga clic en &quot;Abrir editor&quot;.
7. Añadir el código de servicio de ID de visitante.
8. En la parte superior, añada el siguiente código y haga clic en guardar.



```
// Initialize AppMeasurement
var s_account="report suite id"
var s=s_gi(s_account)
/<b></b><b></b> VISITOR ID SERVICE CONFIG - REQUIRES VisitorAPI.js <b></b><b></b>/
s.visitor=Visitor.getInstance("Experience Cloud ID")
```


<b>PASO 6: Agregar acciones: código de Heartbeat</b>

Descargar el SDK de Heartbeat de [https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs](https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs).

Una vez descargado el código de Heartbeat, haga clic en el botón + en acciones para crear un nuevo elemento de acción y, a continuación,

1. Seleccione &quot;Principal&quot; en el menú desplegable Extensión.
2. Seleccione &quot;Código personalizado&quot; en la lista desplegable Tipo de acción.
3. Agregue el nombre de la acción en el cuadro de texto Nombre.
4. Seleccione &quot;Javascript&quot; en Idioma.
5. Marque &quot;Ejecutar globalmente&quot;.
6. Haga clic en &quot;Abrir editor&quot;.
7. Añadir el código de servicio de ID de visitante.
8. En la parte inferior, añada el siguiente código y haga clic en guardar.



```
//Create a local reference to the MediaHeartbeat classes

var MediaHeartbeat = ADB.va.MediaHeartbeat;
var MediaHeartbeatConfig = ADB.va.MediaHeartbeatConfig;
var MediaHeartbeatDelegate = ADB.va.MediaHeartbeatDelegate;

//Media Heartbeat initialization

var mediaConfig = new MediaHeartbeatConfig();
mediaConfig.trackingServer = Configuration.HEARTBEAT.TRACKING_SERVER;
mediaConfig.playerName = Configuration.PLAYER.NAME;
mediaConfig.channel = Configuration.HEARTBEAT.CHANNEL;
mediaConfig.debugLogging = Configuration.HEARTBEAT.DEBUG;

mediaConfig.appVersion = Configuration.HEARTBEAT.SDK;
mediaConfig.ssl = Configuration.HEARTBEAT.SDK;
mediaConfig.ovp = Configuration.HEARTBEAT.OVP;

// Implement the MediaHeartbeatDelegate protocol.
var mediaDelegate = new MediaHeartbeatDelegate();

// Initialize

var appMeasurement = new AppMeasurement();
appMeasurement.visitor = visitor;
appMeasurement.trackingServer = Configuration.APP_MEASUREMENT.TRACKING_SERVER;
appMeasurement.account = Configuration.APP_MEASUREMENT.RSID;
appMeasurement.pageName = Configuration.APP_MEASUREMENT.PAGE_NAME;
appMeasurement.charSet = Configuration.APP_MEASUREMENT.CHAR_SET;
var contextData = {
        pageURL: document.URL,
        isUserLoggedIn: "false",
        tvStation: "Sample TV station",
        programmer: "Khurshid Alam"
        };
var mediaInfo;
var videostarted = false;
var metaDataLoaded = false;
```


<b>PASO 7: Agregar acciones: código de API IFrame de YouTube</b>

1. Seleccione &quot;Principal&quot; en el menú desplegable Extensión.
2. Seleccione &quot;Código personalizado&quot; en la lista desplegable Tipo de acción.
3. Agregue el nombre de la acción en el cuadro de texto Nombre.
4. Seleccione &quot;Javascript&quot; en Idioma.
5. Marque &quot;Ejecutar globalmente&quot;.
6. Haga clic en &quot;Abrir editor&quot;.
7. Agregue el siguiente código y guarde los cambios.



   / 2. Este código carga el código de API del reproductor IFrame de forma asíncrona.





```
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')0;
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

// 3. This function creates an iframe (and YouTube player)
//    after the API code downloads.

var player;
function onYouTubeIframeAPIReady() {
       console.log("onYouTubeIframeAPIReady called...");
       player = new YT.Player('player', {
              height: '390',
              width: '640',
              videoId: 'xWYHvIjvMnY',
              events: {
                     'onReady': onPlayerReady,
                     'onStateChange': onPlayerStateChange,
                     'onPlaybackQualityChange': onPlayerPlaybackQualityChange,
                     'onPlaybackRateChange': onPlayerPlaybackRateChange,
                     'onError': onPlayerError
              }
       });
}
```


// 4. La API invocará esta función cuando el reproductor de vídeo esté listo.


```
function onPlayerReady(event) {
       metaDataLoaded = true;
       player.playVideo();
}

// 5. The API calls this function when the player's state changes.
//    The function indicates that when playing a video (state=1),
//    the player should play for six seconds and then stop.

function onPlayerStateChange(event) {
       switch (event.data){
              case YT.PlayerState.PLAYING:  console.log("\*\*\*HB Playing");
                     if(metaDataLoaded){
                            if (Math.floor(event.target.getCurrentTime()) == 0) {
                                   console.log("\*\*\*HB Start");
                                   MediaHeartbeat = ADB.va.MediaHeartbeat;
                                   mediaInfo = MediaHeartbeat.createMediaObject(
                                          event.target.getVideoData().title,
                                          event.target.getVideoData().video_id,
                                          Math.floor(event.target.getDuration()),
                                         MediaHeartbeat.StreamType.VOD
                                   );
                                   MediaHeartbeat = new MediaHeartbeat(mediaDelegate, mediaConfig, appMeasurement);
                                   mediaDelegate.getCurrentPlaybackTime = function() {
                                   return Math.floor(event.target.getCurrentTime());
                           };
                                   MediaHeartbeat.trackSessionStart(mediaInfo, contextData);
                                   MediaHeartbeat.trackPlay();
                                   videostarted = true;
                     } else {
                           console.log("\*\*\*HB Play");
                           MediaHeartbeat.trackPlay();
                     }}
                     break;
              case YT.PlayerState.PAUSED:
                     console.log("\*\*\*HB Pause");
                     MediaHeartbeat.trackPause();
                     break;
              case YT.PlayerState.ENDED:
                     console.log("\*\*\*HB Ended");
                     MediaHeartbeat.trackComplete();
                     MediaHeartbeat.trackSessionEnd();
                     break;
              case -1:
                     console.log("\*\*\*HB Unloaded");
                     MediaHeartbeat.trackComplete();
                     MediaHeartbeat.trackSessionEnd();
                     break;
       }

}

function onPlayerPlaybackQualityChange(event) {
       console.log("onPlayerPlaybackQualityChange: event.data: "+ event.data);
}

function onPlayerPlaybackRateChange(event) {
       console.log("onPlayerPlaybackRateChange: event.data: "+ event.data);
}

function onPlayerError(event) {
       console.log("onPlayerError: event.data: "+ event.data);
}
```


<b>PASO 8: Añadir un HTML</b>

Agregue el siguiente código en su código de HTML.


```
!-- 1. The iframe (and video player) will replace this div tag. --
div id="player"/divbr

STEP 9: Publish
```

Publique la propiedad y pruebe.

