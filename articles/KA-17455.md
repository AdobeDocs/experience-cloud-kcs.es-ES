---
title: "¿Cómo se bloquean las direcciones IP a nivel de servidor HTTP de Apache?"
description: Descripción
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: “KCS”
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Krunal Oza
article-created-date: "2/16/2023 11:28:45 AM"
article-published-by: Krunal Oza
article-published-date: "2/16/2023 12:02:05 PM"
version-number: 3
article-number: KA-17455
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=9dedd710-edad-ed11-aad1-6045bd006793"
source-git-commit: 1e6d2f4719519731595323dad5f2905c73df4489
workflow-type: tm+mt
source-wordcount: '244'
ht-degree: 3%

---

# ¿Cómo se bloquean las direcciones IP a nivel de servidor HTTP de Apache?

## Descripción {#description}

<b>Entorno</b>
- Experience Manager



<b>Problemas/Síntomas</b>
Nuestro sitio está experimentando un ataque de denegación de servicio, spam o siendo hackeado. ¿Cómo se bloquean las direcciones IP en el nivel del servidor HTTP Apache (AEM Dispatcher)?


## Resolución {#resolution}


La mayoría de los Firewalls de aplicaciones web (WAF), como mod security, pueden listas de bloqueados de direcciones IP. Sin embargo, si está ejecutando el servidor HTTP Apache y desea bloquear las IP inmediatamente, siga estos pasos(<b>No aplicable en AEM as a Cloud Service)</b>:

- Cree un archivo llamado block-offending-ips.conf en su servidor
- Abra el archivo en un editor y agregue una directiva de ubicación que impida que todas las IP ofensivas accedan a las direcciones URL que desee bloquear.  Hay dos opciones para el contenido del archivo a continuación:


<b>A. </b>Si la solicitud se procesa como proxy (a través de CDN, Load Balancer, etc.) y la IP del usuario remoto solo está en un encabezado como X-Forwarded-For, se puede utilizar esta configuración. Tenga en cuenta que esta configuración no se aplica si remoteip_module está configurado.


```
LocationMatch "/.*"
    Order Allow,Deny
    Allow from all
    SetEnvif X-Forwarded-For "10\.42\.137\.123" DenyAccess
    SetEnvif X-Forwarded-For "122\.6\.218\.101" DenyAccess
    #Repeat the "SetEnvlf X-Forwarded-For ..." for each IP you want to block
    Deny from env=DenyAccess
    /LocationMatch
```




<b>B. </b>Alternativamente, si el usuario remoto está accediendo directamente a Apache o está utilizando remoteip_module (consulte [1](https://helpx.adobe.com/experience-manager/kb/block-ips-apache-http-server.html#remoteip_module)) para extraerlo y configurarlo en Apache, puede utilizar directamente la función Require de mod_authz_core (Apache 2.4).


```
LocationMatch "/.*"
    RequireAll
    Require all granted
    Require not ip 10.42.137.123
    Require not ip 122.6.218.101
    #Repeat the "Require not ip ..." for each IP you want to block
    /RequireAll
    /LocationMatch
```

<br><br> <br><br>
1


```
# Extract true client IP from header added by load balancer/CDN
    IfModule remotetip module
    # valid for ELB or ELB+CloudFront
    RemoteIPHeader X-Forwarded-For
    IfModule
```


- Coloque el archivo block-offending-ips.conf en la carpeta /etc/conf.d del servidor web Apache.


- Reinicie el servidor HTTP de Apache.



